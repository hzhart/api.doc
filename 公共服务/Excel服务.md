# Excel服务

## 解析Excel

```
POST /excel/v1/upload
```

> 请求参数: 

<table>
    <tr>
        <th>请求参数</th>
        <th>必须</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>upfile</td>
        <td>是</td>
        <td>上传文件key</td>
    </tr>
</table>

> 返回数据: excel内容

## 生成Excel

```
POST /excel/v1/generate
```

> 请求参数: 

<table>
    <tr>
        <th>请求参数</th>
        <th>必须</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>fileName</td>
        <td>-</td>
        <td>要生成的excel文件名, 不传使用当前时间</td>
    </tr>
    <tr>
        <td>title</td>
        <td>-</td>
        <td>标题行数据, 二维数组, 如[["行一标题一","行二标题二"],["行二标题一","行二标题二"]]</td>
    </tr>
    <tr>
        <td>titleFormat</td>
        <td>-</td>
        <td>标题单元格样式, json对象, excelize规定的样式, 如: {"font":{"bold":true,"size":12},"alignment":{"horizontal":"center","vertical":"center"}}, 代表标题加粗, 12号字体, 水平居中, 垂直居中, 详见文档: https://xuri.me/excelize/zh-hans/style.html</td>
    </tr>
    <tr>
        <td>data</td>
        <td>-</td>
        <td>内容行数据, 二维数组, 如[["内容行一1","内容行一2"],["内容行二1","内容行二2"]]</td>
    </tr>
    <tr>
        <td>cellToMerge</td>
        <td>-</td>
        <td>要合并的单元格, 二维数据, 代表要合并的单元格坐标, 如[[1,1,1,2],[2,1,2,2]], 四个坐标中前两个坐标代表起始单元格的X坐标和Y坐标, 后两个坐标代表结束单元格的X坐标和Y坐标, 上述内容代表合并excel单元格A1和它下方的单元格, 合并B1和它下方的单元格</td>
    </tr>
</table>

> 返回数据: excel文件, 浏览器可直接转向下载

> 范例:

{
    "cellToMerge": [
        [
            1,
            1,
            1,
            2
        ],
        [
            2,
            1,
            2,
            2
        ],
        [
            3,
            1,
            3,
            2
        ],
        [
            4,
            1,
            4,
            2
        ],
        [
            5,
            1,
            12,
            1
        ],
        [
            13,
            1,
            13,
            2
        ],
        [
            14,
            1,
            14,
            2
        ],
        [
            15,
            1,
            15,
            2
        ],
        [
            16,
            1,
            16,
            2
        ],
        [
            17,
            1,
            17,
            2
        ],
        [
            18,
            1,
            18,
            2
        ],
        [
            19,
            1,
            19,
            2
        ],
        [
            20,
            1,
            20,
            2
        ],
        [
            21,
            1,
            21,
            2
        ],
        [
            22,
            1,
            22,
            2
        ],
        [
            23,
            1,
            23,
            2
        ],
        [
            24,
            1,
            24,
            2
        ],
        [
            25,
            1,
            25,
            2
        ],
        [
            26,
            1,
            26,
            2
        ],
        [
            27,
            1,
            27,
            2
        ]
    ],
    "data": [
        [
            "HC1234",
            "海昌",
            "RJ9061S",
            "海昌H20半年抛",
            "软性",
            "38-42%",
            "8.6mm",
            "-0.5",
            "水凝胶",
            "紫色",
            "0.085-0.1mm",
            "半年抛",
            "盒",
            "345",
            "345",
            "福建厦门",
            "8242405",
            "100g",
            "",
            "",
            "2018年夏",
            "省经销商",
            "123456",
            "推荐",
            "0",
            "今日推荐",
            ""
        ],
        [
            "HC1234",
            "海昌",
            "RJ9061S",
            "海昌H20半年抛",
            "软性",
            "38-42%",
            "8.6mm",
            "-0.5",
            "水凝胶",
            "紫色",
            "0.085-0.1mm",
            "半年抛",
            "盒",
            "345",
            "345",
            "福建厦门",
            "8242405",
            "100g",
            "",
            "",
            "2018年夏",
            "省经销商",
            "123456",
            "推荐",
            "0",
            "今日推荐",
            ""
        ],
        [
            "HC1234",
            "海昌",
            "RJ9061S",
            "海昌H20半年抛",
            "软性",
            "38-42%",
            "8.6mm",
            "-0.5",
            "水凝胶",
            "紫色",
            "0.085-0.1mm",
            "半年抛",
            "盒",
            "345",
            "345",
            "福建厦门",
            "8242405",
            "100g",
            "",
            "",
            "2018年夏",
            "省经销商",
            "123456",
            "推荐",
            "0",
            "今日推荐",
            ""
        ],
        [
            "HC1234",
            "海昌",
            "RJ9061S",
            "海昌H20半年抛",
            "软性",
            "38-42%",
            "8.6mm",
            "-0.5",
            "水凝胶",
            "紫色",
            "0.085-0.1mm",
            "半年抛",
            "盒",
            "345",
            "345",
            "福建厦门",
            "8242405",
            "100g",
            "",
            "",
            "2018年夏",
            "省经销商",
            "123456",
            "推荐",
            "0",
            "今日推荐",
            ""
        ]
    ],
    "fileName": "excelFile",
    "title": [
        [
            "编号",
            "品牌",
            "型号",
            "名称",
            "规格",
            "",
            "",
            "",
            "",
            "",
            "",
            "",
            "单位",
            "参考进价",
            "售价",
            "产地",
            "货号",
            "毛重",
            "生产企业",
            "注册证号",
            "上市时间",
            "供货商",
            "条码",
            "关键词",
            "排序",
            "标签",
            "备注"
        ],
        [
            "",
            "",
            "",
            "",
            "功能",
            "含水",
            "基弧",
            "度数",
            "材质",
            "颜色",
            "中心厚度",
            "佩戴周期"
        ]
    ],
    "titleFormat": {
        "alignment": {
            "horizontal": "center",
            "vertical": "center"
        },
        "font": {
            "bold": true,
            "size": 12
        }
    }
}

